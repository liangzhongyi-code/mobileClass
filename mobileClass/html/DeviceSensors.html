<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sensor Dashboard</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --stop-color: #e74c3c;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-main: #2c3e50;
            --text-sub: #7f8c8d;
        }

        * { box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            padding-bottom: 50px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* --- æ¨™é¡Œå€ --- */
        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h2 {
            margin: 0 0 10px 0;
            color: var(--text-main);
        }

        /* --- æ§åˆ¶å€ --- */
        .controls {
            margin-bottom: 25px;
            text-align: center;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: 20px;
            background: #eee;
            color: #666;
            font-weight: 500;
            transition: all 0.3s;
        }

        button#actionBtn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 16px 32px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        button#actionBtn.running {
            background-color: var(--stop-color);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
        }

        button#actionBtn:active { transform: scale(0.98); }

        /* --- æ•¸æ“šå„€è¡¨æ¿ --- */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        @media (min-width: 600px) {
            .dashboard { grid-template-columns: 1fr 1fr; }
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            border: 1px solid rgba(0,0,0,0.02);
        }

        .card h3 {
            margin: 0 0 12px 0;
            font-size: 1rem;
            color: var(--primary-color);
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 8px;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.95rem;
            color: var(--text-sub);
        }

        .data-val {
            font-family: 'Courier New', Courier, monospace;
            font-weight: 700;
            color: var(--text-main);
            background: #f0f2f5;
            padding: 4px 8px;
            border-radius: 6px;
            min-width: 75px;
            text-align: right;
            letter-spacing: -0.5px;
        }
    </style>
</head>
<body>

<div class="container">

    <header>
        <h2>æ„Ÿæ¸¬å™¨æ•¸æ“šç›£æ§</h2>
    </header>

    <div class="controls">
        <div id="statusBadge" class="status-badge">ç­‰å¾…å•Ÿå‹•...</div>
        <br>
        <button id="actionBtn">
            <span id="btnIcon">â–¶</span>
            <span id="btnText">å–å¾—æˆæ¬Šä¸¦é–‹å§‹</span>
        </button>
    </div>

    <div class="dashboard">
        <div class="card">
            <h3>DeviceOrientation (æ–¹å‘è§’åº¦)</h3>
            <div class="data-row">Alpha (Z) <span class="data-val" id="alpha">-</span></div>
            <div class="data-row">Beta (X) <span class="data-val" id="beta">-</span></div>
            <div class="data-row">Gamma (Y) <span class="data-val" id="gamma">-</span></div>
        </div>

        <div class="card">
            <h3>DeviceMotion (åŠ é€Ÿåº¦)</h3>
            <div class="data-row">ax <span class="data-val" id="ax">-</span></div>
            <div class="data-row">ay <span class="data-val" id="ay">-</span></div>
            <div class="data-row">az <span class="data-val" id="az">-</span></div>
        </div>

        <div class="card">
            <h3>Motion + Gravity (å«é‡åŠ›)</h3>
            <div class="data-row">ax_g <span class="data-val" id="ax_g">-</span></div>
            <div class="data-row">ay_g <span class="data-val" id="ay_g">-</span></div>
            <div class="data-row">az_g <span class="data-val" id="az_g">-</span></div>
        </div>

        <div class="card">
            <h3>Gyroscope (æ—‹è½‰é€Ÿç‡)</h3>
            <div class="data-row">Î± (Rate) <span class="data-val" id="rAlpha">-</span></div>
            <div class="data-row">Î² (Rate) <span class="data-val" id="rBeta">-</span></div>
            <div class="data-row">Î³ (Rate) <span class="data-val" id="rGamma">-</span></div>
        </div>
    </div>
</div>

<script>
    // UI Elements
    const actionBtn = document.getElementById("actionBtn");
    const btnText = document.getElementById("btnText");
    const btnIcon = document.getElementById("btnIcon");
    const statusBadge = document.getElementById("statusBadge");

    // Data Elements
    const els = {
        alpha: document.getElementById("alpha"),
        beta:  document.getElementById("beta"),
        gamma: document.getElementById("gamma"),
        ax:    document.getElementById("ax"),
        ay:    document.getElementById("ay"),
        az:    document.getElementById("az"),
        axg:   document.getElementById("ax_g"),
        ayg:   document.getElementById("ay_g"),
        azg:   document.getElementById("az_g"),
        ra:    document.getElementById("rAlpha"),
        rb:    document.getElementById("rBeta"),
        rg:    document.getElementById("rGamma")
    };

    let isRunning = false;

    // --- äº‹ä»¶è™•ç†å‡½å¼ ---

    function handleOrientation(event) {
        els.alpha.textContent = event.alpha?.toFixed(1) ?? "-";
        els.beta.textContent  = event.beta?.toFixed(1) ?? "-";
        els.gamma.textContent = event.gamma?.toFixed(1) ?? "-";
    }

    function handleMotion(event) {
        const acc = event.acceleration || {};
        els.ax.textContent = acc.x?.toFixed(2) ?? "-";
        els.ay.textContent = acc.y?.toFixed(2) ?? "-";
        els.az.textContent = acc.z?.toFixed(2) ?? "-";

        const accG = event.accelerationIncludingGravity || {};
        els.axg.textContent = accG.x?.toFixed(2) ?? "-";
        els.ayg.textContent = accG.y?.toFixed(2) ?? "-";
        els.azg.textContent = accG.z?.toFixed(2) ?? "-";

        const rot = event.rotationRate || {};
        els.ra.textContent = rot.alpha?.toFixed(2) ?? "-";
        els.rb.textContent = rot.beta?.toFixed(2) ?? "-";
        els.rg.textContent = rot.gamma?.toFixed(2) ?? "-";
    }

    // --- å•Ÿå‹•èˆ‡åœæ­¢é‚è¼¯ ---

    function startSensors() {
        window.addEventListener("deviceorientation", handleOrientation);
        window.addEventListener("devicemotion", handleMotion);

        isRunning = true;
        updateUIState(true);
    }

    function stopSensors() {
        window.removeEventListener("deviceorientation", handleOrientation);
        window.removeEventListener("devicemotion", handleMotion);

        isRunning = false;
        updateUIState(false);
    }

    function updateUIState(running) {
        if (running) {
            actionBtn.classList.add("running");
            btnText.textContent = "åœæ­¢åµæ¸¬";
            btnIcon.textContent = "â¹";
            statusBadge.textContent = "ğŸŸ¢ æ­£åœ¨å³æ™‚ç›£æ¸¬ä¸­";
            statusBadge.style.color = "#155724";
            statusBadge.style.background = "#d4edda";
            statusBadge.style.border = "1px solid #c3e6cb";
        } else {
            actionBtn.classList.remove("running");
            btnText.textContent = "é‡æ–°é–‹å§‹åµæ¸¬";
            btnIcon.textContent = "â–¶";
            statusBadge.textContent = "ğŸ”´ åµæ¸¬å·²æš«åœ";
            statusBadge.style.color = "#721c24";
            statusBadge.style.background = "#f8d7da";
            statusBadge.style.border = "1px solid #f5c6cb";
        }
    }

    // --- æŒ‰éˆ•é»æ“Šäº‹ä»¶ ---

    actionBtn.addEventListener("click", async () => {
        if (isRunning) {
            stopSensors();
            return;
        }

        try {
            // iOS 13+ æ¬Šé™è«‹æ±‚ (Orientation)
            if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === "function") {
                const permission = await DeviceOrientationEvent.requestPermission();
                if (permission !== "granted") {
                    alert("æ¬Šé™è¢«æ‹’çµ•ï¼šç„¡æ³•å­˜å–æ–¹å‘æ„Ÿæ¸¬å™¨");
                    return;
                }
            }

            // iOS 13+ æ¬Šé™è«‹æ±‚ (Motion)
            if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === "function") {
                const permission = await DeviceMotionEvent.requestPermission();
                if (permission !== "granted") {
                    alert("æ¬Šé™è¢«æ‹’çµ•ï¼šç„¡æ³•å­˜å–å‹•ä½œæ„Ÿæ¸¬å™¨");
                    return;
                }
            }

            startSensors();

        } catch (error) {
            console.error(error);
            alert("ç™¼ç”ŸéŒ¯èª¤ï¼š" + error);
        }
    });
</script>

</body>
</html>