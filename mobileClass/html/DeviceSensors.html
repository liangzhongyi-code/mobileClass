<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>è£ç½®æ„Ÿæ¸¬å™¨</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --stop-color: #e74c3c;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-main: #2c3e50;
            --text-sub: #7f8c8d;
        }

        * { box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            padding-bottom: 50px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* --- 3D è¦–è¦ºåŒ–å€åŸŸ --- */
        .scene-container {
            width: 100%;
            height: 300px;
            background: radial-gradient(circle at center, #e0e5ec 0%, #ffffff 100%);
            border-radius: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            perspective: 1000px; /* 3D é€è¦–æ·±åº¦ */
            overflow: hidden;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
        }

        /* æ‰‹æ©Ÿæ¨¡å‹å®¹å™¨ */
        .phone-model {
            width: 140px;
            height: 260px;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateX(0deg) rotateY(0deg) rotateZ(0deg);
            transition: transform 0.1s linear; /* å¹³æ»‘éæ¸¡ */
        }

        /* æ‰‹æ©Ÿçš„å…­å€‹é¢ (CSS Cube) */
        .face {
            position: absolute;
            background: #333;
            border: 1px solid #222;
            border-radius: 12px;
            opacity: 0.95;
        }

        /* æ­£é¢ (è¢å¹•) */
        .front {
            width: 140px;
            height: 260px;
            background: #111;
            transform: translateZ(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            border: 4px solid #444;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
        }

        /* è¢å¹•ç•«é¢ */
        .screen-content {
            width: 90%;
            height: 92%;
            background: linear-gradient(135deg, #4a90e2 0%, #9013fe 100%);
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 0.8rem;
            text-align: center;
            position: relative;
        }

        /* æ¨¡æ“¬ç€æµ·/é¡é ­ */
        .notch {
            position: absolute;
            top: 5px;
            width: 40%;
            height: 10px;
            background: #000;
            border-bottom-left-radius: 6px;
            border-bottom-right-radius: 6px;
        }

        /* èƒŒé¢ */
        .back {
            width: 140px;
            height: 260px;
            background: #444;
            transform: translateZ(-10px) rotateY(180deg);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .logo {
            width: 30px;
            height: 30px;
            background: #666;
            border-radius: 50%;
        }

        /* å´é¢ (åšåº¦) - ç°¡åŒ–è™•ç†ï¼Œä½¿ç”¨å½å…ƒç´ æˆ–é¡å¤–div */
        .side-left  { width: 20px; height: 260px; transform: rotateY(-90deg) translateZ(10px); left: -10px; background: #2a2a2a; }
        .side-right { width: 20px; height: 260px; transform: rotateY(90deg) translateZ(130px); left: -10px; background: #2a2a2a; }
        .side-top   { width: 140px; height: 20px; transform: rotateX(90deg) translateZ(10px); top: -10px; background: #2a2a2a; }
        .side-bottom{ width: 140px; height: 20px; transform: rotateX(-90deg) translateZ(250px); top: -10px; background: #2a2a2a; }


        /* --- æ§åˆ¶å€ --- */
        .controls {
            margin-bottom: 25px;
            text-align: center;
        }

        button#actionBtn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 16px 32px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        button#actionBtn.running {
            background-color: var(--stop-color);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
        }

        button#actionBtn:active { transform: scale(0.98); }

        /* --- æ•¸æ“šå„€è¡¨æ¿ --- */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        @media (min-width: 600px) {
            .dashboard { grid-template-columns: 1fr 1fr; }
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .card h3 {
            margin: 0 0 12px 0;
            font-size: 1rem;
            color: var(--primary-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 0.95rem;
            color: var(--text-sub);
        }

        .data-val {
            font-family: 'Courier New', monospace;
            font-weight: 700;
            color: var(--text-main);
            background: #f0f2f5;
            padding: 2px 6px;
            border-radius: 4px;
            min-width: 70px;
            text-align: right;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-bottom: 10px;
            background: #eee;
            color: #666;
        }
    </style>
</head>
<body>

<div class="container">

    <div class="scene-container">
        <div class="phone-model" id="phone3d">
            <div class="face front">
                <div class="screen-content">
                    <div class="notch"></div>
                    <div>CSS 3D</div>
                </div>
            </div>
            <div class="face back"><div class="logo"></div></div>
            <div class="face side-left"></div>
            <div class="face side-right"></div>
            <div class="face side-top"></div>
            <div class="face side-bottom"></div>
        </div>
    </div>

    <div class="controls">
        <div id="statusBadge" class="status-badge">ç­‰å¾…å•Ÿå‹•...</div>
        <br>
        <button id="actionBtn">
            <span id="btnIcon">â–¶</span>
            <span id="btnText">å–å¾—æˆæ¬Šä¸¦é–‹å§‹</span>
        </button>
    </div>

    <div class="dashboard">
        <div class="card">
            <h3>DeviceOrientation (æ–¹å‘)</h3>
            <div class="data-row">Alpha (Z) <span class="data-val" id="alpha">-</span></div>
            <div class="data-row">Beta (X) <span class="data-val" id="beta">-</span></div>
            <div class="data-row">Gamma (Y) <span class="data-val" id="gamma">-</span></div>
        </div>

        <div class="card">
            <h3>DeviceMotion (åŠ é€Ÿåº¦)</h3>
            <div class="data-row">ax <span class="data-val" id="ax">-</span></div>
            <div class="data-row">ay <span class="data-val" id="ay">-</span></div>
            <div class="data-row">az <span class="data-val" id="az">-</span></div>
        </div>

        <div class="card">
            <h3>Motion + Gravity (å«é‡åŠ›)</h3>
            <div class="data-row">ax_g <span class="data-val" id="ax_g">-</span></div>
            <div class="data-row">ay_g <span class="data-val" id="ay_g">-</span></div>
            <div class="data-row">az_g <span class="data-val" id="az_g">-</span></div>
        </div>

        <div class="card">
            <h3>Gyroscope (è½‰é€Ÿ)</h3>
            <div class="data-row">Î± (Rate) <span class="data-val" id="rAlpha">-</span></div>
            <div class="data-row">Î² (Rate) <span class="data-val" id="rBeta">-</span></div>
            <div class="data-row">Î³ (Rate) <span class="data-val" id="rGamma">-</span></div>
        </div>
    </div>
</div>

<script>
    // UI Elements
    const actionBtn = document.getElementById("actionBtn");
    const btnText = document.getElementById("btnText");
    const btnIcon = document.getElementById("btnIcon");
    const statusBadge = document.getElementById("statusBadge");
    const phone3d = document.getElementById("phone3d");

    // Data Elements
    const els = {
        alpha: document.getElementById("alpha"),
        beta:  document.getElementById("beta"),
        gamma: document.getElementById("gamma"),
        ax:    document.getElementById("ax"),
        ay:    document.getElementById("ay"),
        az:    document.getElementById("az"),
        axg:   document.getElementById("ax_g"),
        ayg:   document.getElementById("ay_g"),
        azg:   document.getElementById("az_g"),
        ra:    document.getElementById("rAlpha"),
        rb:    document.getElementById("rBeta"),
        rg:    document.getElementById("rGamma")
    };

    let isRunning = false;

    // --- äº‹ä»¶è™•ç†å‡½å¼ ---

    // è™•ç†æ–¹å‘ (Orientation) èˆ‡ 3D ç¿»è½‰
    function handleOrientation(event) {
        // è®€å–æ•¸æ“š (å¯èƒ½ç‚º null)
        const alpha = event.alpha || 0; // Zè»¸ 0-360
        const beta  = event.beta  || 0; // Xè»¸ -180~180 (å‰å¾Œå‚¾æ–œ)
        const gamma = event.gamma || 0; // Yè»¸ -90~90 (å·¦å³å‚¾æ–œ)

        // æ›´æ–°æ–‡å­—
        els.alpha.textContent = alpha.toFixed(1);
        els.beta.textContent  = beta.toFixed(1);
        els.gamma.textContent = gamma.toFixed(1);

        // æ›´æ–° 3D æ¨¡å‹
        // æ³¨æ„ï¼šCSS çš„æ—‹è½‰è»¸å®šç¾©èˆ‡æ„Ÿæ¸¬å™¨ç•¥æœ‰ä¸åŒï¼Œé€™è£¡åšç°¡å–®å°æ‡‰
        // rotateZ: å°æ‡‰ Alpha (ç¾…ç›¤)
        // rotateX: å°æ‡‰ Beta (å‰å¾Œç¿») - éœ€æ³¨æ„æ­£è² æ–¹å‘
        // rotateY: å°æ‡‰ Gamma (å·¦å³ç¿») - éœ€æ³¨æ„æ­£è² æ–¹å‘
        // åŠ ä¸Š transform-origin: center center; (CSS é è¨­)

        // æ¸›å»åˆå§‹åç§»æˆ–åè½‰è»¸å‘ä»¥ç¬¦åˆè¦–è¦ºç›´è¦º
        phone3d.style.transform = `rotateZ(${alpha}deg) rotateX(${beta}deg) rotateY(${gamma}deg)`;
    }

    // è™•ç†å‹•ä½œ (Motion)
    function handleMotion(event) {
        const acc = event.acceleration || {};
        els.ax.textContent = acc.x?.toFixed(2) ?? "-";
        els.ay.textContent = acc.y?.toFixed(2) ?? "-";
        els.az.textContent = acc.z?.toFixed(2) ?? "-";

        const accG = event.accelerationIncludingGravity || {};
        els.axg.textContent = accG.x?.toFixed(2) ?? "-";
        els.ayg.textContent = accG.y?.toFixed(2) ?? "-";
        els.azg.textContent = accG.z?.toFixed(2) ?? "-";

        const rot = event.rotationRate || {};
        els.ra.textContent = rot.alpha?.toFixed(2) ?? "-";
        els.rb.textContent = rot.beta?.toFixed(2) ?? "-";
        els.rg.textContent = rot.gamma?.toFixed(2) ?? "-";
    }

    // --- å•Ÿå‹•èˆ‡åœæ­¢é‚è¼¯ ---

    function startSensors() {
        window.addEventListener("deviceorientation", handleOrientation);
        window.addEventListener("devicemotion", handleMotion);

        isRunning = true;
        updateUIState(true);
    }

    function stopSensors() {
        window.removeEventListener("deviceorientation", handleOrientation);
        window.removeEventListener("devicemotion", handleMotion);

        isRunning = false;
        updateUIState(false);

        // é‡ç½® 3D æ¨¡å‹ä½ç½®
        phone3d.style.transform = "rotateX(0deg) rotateY(0deg) rotateZ(0deg)";

        // å¯é¸ï¼šé‡ç½®æ•¸å€¼é¡¯ç¤º
        // Object.values(els).forEach(el => el.textContent = "-");
    }

    function updateUIState(running) {
        if (running) {
            actionBtn.classList.add("running");
            btnText.textContent = "åœæ­¢åµæ¸¬";
            btnIcon.textContent = "â¹";
            statusBadge.textContent = "ğŸŸ¢ æ­£åœ¨æ¥æ”¶æ„Ÿæ¸¬å™¨æ•¸æ“š...";
            statusBadge.style.color = "#28a745";
            statusBadge.style.background = "#e6f9ed";
        } else {
            actionBtn.classList.remove("running");
            btnText.textContent = "é‡æ–°é–‹å§‹åµæ¸¬";
            btnIcon.textContent = "â–¶";
            statusBadge.textContent = "ğŸ”´ åµæ¸¬å·²æš«åœ";
            statusBadge.style.color = "#dc3545";
            statusBadge.style.background = "#fce8e6";
        }
    }

    // --- æŒ‰éˆ•é»æ“Šäº‹ä»¶ ---

    actionBtn.addEventListener("click", async () => {
        // å¦‚æœæ­£åœ¨åŸ·è¡Œï¼Œå°±åœæ­¢
        if (isRunning) {
            stopSensors();
            return;
        }

        // å¦‚æœæ˜¯åœæ­¢ç‹€æ…‹ï¼Œå˜—è©¦å•Ÿå‹• (éœ€è™•ç†æˆæ¬Š)
        try {
            // iOS 13+ æ¬Šé™è«‹æ±‚ (Orientation)
            if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === "function") {
                const permission = await DeviceOrientationEvent.requestPermission();
                if (permission !== "granted") {
                    alert("æ‚¨æ‹’çµ•äº†æ–¹å‘æ„Ÿæ¸¬å™¨æ¬Šé™");
                    return;
                }
            }

            // iOS 13+ æ¬Šé™è«‹æ±‚ (Motion)
            if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === "function") {
                const permission = await DeviceMotionEvent.requestPermission();
                if (permission !== "granted") {
                    alert("æ‚¨æ‹’çµ•äº†å‹•ä½œæ„Ÿæ¸¬å™¨æ¬Šé™");
                    return;
                }
            }

            // æˆæ¬Šé€šéæˆ–ä¸éœ€è¦æˆæ¬Šï¼Œé–‹å§‹ç›£è½
            startSensors();

        } catch (error) {
            console.error(error);
            alert("ç™¼ç”ŸéŒ¯èª¤ï¼š" + error);
        }
    });
</script>

</body>
</html>